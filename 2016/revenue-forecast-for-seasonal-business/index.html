<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>


    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/nitinahuja.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Nitin Ahuja",
    
    "image": "https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d"
    
  },
  "name":"A programmer\u0027s viewpoint",
  "description":"Revenue forecasting with linear methods. This post highlights linear regression techniques on time series data. We have some weekly sales data from a small business that is expected to have seasonal trends. A bike rental business in a major tourist city. Let\u0026rsquo;s dive into the data. Load up the required packages.\nsuppressPackageStartupMessages({ library(forecast) }) Load the data, we have two columns with weekly revenue numbers from two different sources. Online and Phone; these correspond to sales online and via phone call to the business.",
  "url":"https:\/\/nitinahuja.github.io\/2016\/revenue-forecast-for-seasonal-business\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.118.2 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Nitin Ahuja">
<meta name="keywords" content="">
<meta name="description" content="Revenue forecasting with linear methods. This post highlights linear regression techniques on time series data. We have some weekly sales data from a small business that is expected to have seasonal trends. A bike rental business in a major tourist city. Let&rsquo;s dive into the data. Load up the required packages.
suppressPackageStartupMessages({ library(forecast) }) Load the data, we have two columns with weekly revenue numbers from two different sources. Online and Phone; these correspond to sales online and via phone call to the business.">


<meta property="og:description" content="Revenue forecasting with linear methods. This post highlights linear regression techniques on time series data. We have some weekly sales data from a small business that is expected to have seasonal trends. A bike rental business in a major tourist city. Let&rsquo;s dive into the data. Load up the required packages.
suppressPackageStartupMessages({ library(forecast) }) Load the data, we have two columns with weekly revenue numbers from two different sources. Online and Phone; these correspond to sales online and via phone call to the business.">
<meta property="og:type" content="article">
<meta property="og:title" content="Revenue forecast for seasonal business">
<meta name="twitter:title" content="Revenue forecast for seasonal business">
<meta property="og:url" content="https://nitinahuja.github.io/2016/revenue-forecast-for-seasonal-business/">
<meta property="twitter:url" content="https://nitinahuja.github.io/2016/revenue-forecast-for-seasonal-business/">
<meta property="og:site_name" content="A programmer&#39;s viewpoint">
<meta property="og:description" content="Revenue forecasting with linear methods. This post highlights linear regression techniques on time series data. We have some weekly sales data from a small business that is expected to have seasonal trends. A bike rental business in a major tourist city. Let&rsquo;s dive into the data. Load up the required packages.
suppressPackageStartupMessages({ library(forecast) }) Load the data, we have two columns with weekly revenue numbers from two different sources. Online and Phone; these correspond to sales online and via phone call to the business.">
<meta name="twitter:description" content="Revenue forecasting with linear methods. This post highlights linear regression techniques on time series data. We have some weekly sales data from a small business that is expected to have seasonal trends. A bike rental business in a major tourist city. Let&rsquo;s dive into the data. Load up the required packages.
suppressPackageStartupMessages({ library(forecast) }) Load the data, we have two columns with weekly revenue numbers from two different sources. Online and Phone; these correspond to sales online and via phone call to the business.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2016-05-09T00:00:00">
  
  
    <meta property="article:modified_time" content="2016-05-09T00:00:00">
  
  
  
    
      <meta property="article:section" content="R">
    
  
  
    
      <meta property="article:tag" content="forecasting">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@nitinahuja">


  <meta name="twitter:creator" content="@nitinahuja">






  <meta property="og:image" content="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=640">




  <meta property="og:image" content="https://nitinahuja.github.io/img/forecast.jpg">
  <meta property="twitter:image" content="https://nitinahuja.github.io/img/forecast.jpg">


  <meta property="og:image" content="https://nitinahuja.github.io/img/forecast_thumb.jpg">
  <meta property="twitter:image" content="https://nitinahuja.github.io/img/forecast_thumb.jpg">


    <title>Revenue forecast for seasonal business</title>

    <link rel="icon" href="https://nitinahuja.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://nitinahuja.github.io/2016/revenue-forecast-for-seasonal-business/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://nitinahuja.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://nitinahuja.github.io/css/codefolding.css">
      
    
      
        <link rel="stylesheet"  crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-105634890-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://nitinahuja.github.io/" aria-label="Go to homepage">A programmer&#39;s viewpoint</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://nitinahuja.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
  

<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>


</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://nitinahuja.github.io/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Nitin Ahuja</h4>
        
          <h5 class="sidebar-profile-bio">A programmer&rsquo;s viewpoint</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/" title="Home">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/nitinahuja" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-left
              "
       style="background-image:url('/img/forecast.jpg')"
       data-behavior="4">
    
      <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Revenue forecast for seasonal business
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2016-05-09T00:00:00Z">
        
  May 9, 2016

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://nitinahuja.github.io/categories/r">R</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <h2 id="revenue-forecasting-with-linear-methods">Revenue forecasting with linear methods.</h2>
<p>This post highlights linear regression techniques on time series data. We have some weekly sales data from a small business that is expected to have seasonal trends. A bike rental business in a major tourist city. Let&rsquo;s dive into the data.
Load up the required packages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">suppressPackageStartupMessages</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span>(forecast)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>Load the data, we have two columns with weekly revenue numbers from two different sources. Online and Phone; these correspond to sales online and via phone call to the business.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  filename <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;~/data/BikeTours.csv&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Read up the data file - first line is the header</span>
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(filename, header <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the seller name</span>
</span></span><span style="display:flex;"><span>    sellerName <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34;/|~.*data|.csv&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, filename)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">str</span>(d)
</span></span></code></pre></div><pre tabindex="0"><code>## &#39;data.frame&#39;:	220 obs. of  2 variables:
##  $ Online: num  0.001 0.001 104 442 156 52 312 0.001 0.001 854 ...
##  $ Phone : num  0.001 0.001 0.001 0.001 44.5 0.001 0.001 141 0.001 0.001 ...
</code></pre><h2 id="the-weekly-revenue-for-_biketours_">The weekly revenue for <em>BikeTours</em></h2>
<h3 id="timeseries">Timeseries</h3>
<p>Let start by creating a timeseries object using the <code>ts()</code> function and has the signature <code>ts(vector, start=,end=,frequency)</code> where start and end are times of the first and last observation and frequency is the number of observations per unit time (1=annual, 4=quarterly, 12=monthly).
In our case we have weekly data, therefore we will set our frequncy to 52.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  d_ts <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ts</span>(d, start <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2012</span>,<span style="color:#ae81ff">1</span>), frequency <span style="color:#f92672">=</span> <span style="color:#ae81ff">52</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span>(d_ts)
</span></span></code></pre></div><pre tabindex="0"><code>##      Online             Phone         
##  Min.   :   0.001   Min.   :   0.001  
##  1st Qu.: 211.000   1st Qu.:   0.001  
##  Median :1824.500   Median : 191.500  
##  Mean   :1959.751   Mean   : 333.967  
##  3rd Qu.:3112.500   3rd Qu.: 571.875  
##  Max.   :8505.000   Max.   :1733.000
</code></pre><h3 id="online-and-phone-revenue">Online and Phone revenue</h3>
<p>Let&rsquo;s look at the weekly sales split out by mode of purchase Online vs Phone. Online sales are the primary component of sales. For the next few sections we will focus on the Online component. The same analysis and forecast can be done for the Phone component.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  title <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34; Seasonal decompsition for &#34;</span>, sellerName) 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ts.plot</span>(d_ts, gpars <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(col<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;tomato&#34;</span>, <span style="color:#e6db74">&#34;magenta&#34;</span>), lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Gross Sales&#34;</span>, xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;year&#34;</span>, main <span style="color:#f92672">=</span> title))
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">legend</span>(<span style="color:#e6db74">&#39;topleft&#39;</span> ,legend<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Online&#34;</span>, <span style="color:#e6db74">&#34;Phone&#34;</span>), lty<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;tomato&#34;</span>, <span style="color:#e6db74">&#34;magenta&#34;</span>), bty<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;n&#39;</span>, cex<span style="color:#f92672">=</span><span style="color:#ae81ff">.75</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/unnamed-chunk-4-1.png" width="672" />
<h3 id="online-revenue">Online Revenue</h3>
<h4 id="seasonal-component-extraction">Seasonal component extraction.</h4>
<p>When a time series varies according to a periodic component, we can extract the periodicty using classical statistical methods. The <strong>stl()</strong> function in core R uses <em>loess</em> to effectively take the means of each period. The seasonal component is removed and the remainder is smoothed to find the trend.
The sales are clearly seasonal with peaks in the middle of the year starting near spring break and ending near thanksgiving.</p>
<p>Weekly revenue with the seasonal component extracted</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  d_online <span style="color:#f92672">&lt;-</span> d<span style="color:#f92672">$</span>Online
</span></span><span style="display:flex;"><span>  d_ts_online <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ts</span>(d_online, start <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2012</span>,<span style="color:#ae81ff">1</span>), frequency <span style="color:#f92672">=</span> params<span style="color:#f92672">$</span>freq)
</span></span><span style="display:flex;"><span>  d_ts_comp_online <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">stl</span>(d_ts_online, s.window <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;period&#34;</span>, robust <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)            
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(d_ts_comp_online, main <span style="color:#f92672">=</span> title)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/unnamed-chunk-5-1.png" width="672" />
<p>Let&rsquo;s combine this into a single plot. We have also extracted the seasonally adjusted numbers to show the actual variations and trends.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(d_ts_online, ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Gross Revenue&#34;</span>, main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Online gross revenue with trend and seasonal parts&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lines</span>(d_ts_comp_online<span style="color:#f92672">$</span>time.series[,<span style="color:#ae81ff">2</span>], col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tomato&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lines</span>(<span style="color:#a6e22e">seasadj</span>(d_ts_comp_online), col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lines</span>(d_ts_comp_online<span style="color:#f92672">$</span>time.series[,<span style="color:#ae81ff">1</span>], col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">legend</span>(<span style="color:#e6db74">&#39;topleft&#39;</span> ,legend<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Actual&#34;</span>, <span style="color:#e6db74">&#34;trend&#34;</span>, <span style="color:#e6db74">&#34;seasonal adj&#34;</span>, <span style="color:#e6db74">&#34;seasonal&#34;</span>), lty<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;black&#34;</span>, <span style="color:#e6db74">&#34;tomato&#34;</span>, <span style="color:#e6db74">&#34;green&#34;</span>, <span style="color:#e6db74">&#34;blue&#34;</span>), bty<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;n&#39;</span>, cex<span style="color:#f92672">=</span><span style="color:#ae81ff">.75</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/unnamed-chunk-6-1.png" width="672" />
<h3 id="forecast-using-linear-regression">Forecast using linear regression</h3>
<p>This is the forecast for revenue taking seasonality into account. The function <strong>tslm()</strong> is the linear regression version for time series data.</p>
<p>Note the red line shows the model&rsquo;s predicted numbers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>    f_online<span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">tslm</span>(d_ts_online <span style="color:#f92672">~</span> trend <span style="color:#f92672">+</span> season, lambda <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>    ff_online <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">forecast</span>(f_online, h<span style="color:#f92672">=</span>params<span style="color:#f92672">$</span>freq)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">plot</span>(ff_online,  ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Online Gross Revenue&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lines</span>(<span style="color:#a6e22e">fitted</span>(ff_online), col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lines</span>(d_ts_comp_online<span style="color:#f92672">$</span>time.series[,<span style="color:#ae81ff">2</span>], col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tomato&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/unnamed-chunk-7-1.png" width="672" />
<h3 id="forecast-using-arima-models">Forecast using ARIMA models</h3>
<p>Let&rsquo;s also use the [ARIMA](<a href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average">https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average</a> Wikipedia) model to get a forecast.
Note that the <em>D=1</em> parameter forces the model to take seasonality into account.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>    f_online_arima <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">auto.arima</span>(d_ts_online, lambda <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, D<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    ff_online_arima <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">forecast</span>(f_online_arima, h<span style="color:#f92672">=</span>params<span style="color:#f92672">$</span>freq)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">plot</span>(ff_online_arima,  ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Online Gross Revenue&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lines</span>(<span style="color:#a6e22e">fitted</span>(ff_online_arima), col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lines</span>(d_ts_comp_online<span style="color:#f92672">$</span>time.series[,<span style="color:#ae81ff">2</span>], col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tomato&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/unnamed-chunk-8-1.png" width="672" />
<h3 id="residuals">Residuals</h3>
<p>The residuals - the difference between the actual and predicted values back fitted. Low numbers are indicative of a good fit.
A 0 mean is indicative of an unbiased forecast.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">residuals</span>(ff_online)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">plot</span>(res, ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Residuals&#34;</span>,xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Year&#34;</span>, main <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;Residuals for &#34;</span>, sellerName) )
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/5.1-1.png" width="672" />
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">summary</span>(res)
</span></span></code></pre></div><pre tabindex="0"><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -41.166  -9.406  -1.330   0.000   8.180  45.450
</code></pre><h3 id="autocorrelation">Autocorrelation</h3>
<p>The <em>autocorrelation</em> shows the correlation between seasonal data, peaks show positive correlation at the marked intervals. ( 52 weeks, so yearly correlation is statistically signficant - i.e. above the blue line)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#a6e22e">Acf</span>(d_ts_online , main<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ACF of revenue&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2016-05-09-revenue-forecast-for-seasonal-business_files/figure-html/5.2-1.png" width="672" />
<p>This is the weekly revenue prediction using this model</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  ff_online
</span></span></code></pre></div><pre tabindex="0"><code>##          Point Forecast        Lo 80     Hi 80       Lo 95      Hi 95
## 2016.231      932.32319  318.4182798 1868.2845  122.377409  2500.5504
## 2016.250     2578.50032 1450.7906998 4028.2664  980.153309  4935.1287
## 2016.269     2899.35343 1693.8126535 4426.9506 1181.579368  5375.4089
## 2016.288     3636.01505 2266.6825172 5327.4040 1666.912767  6363.3987
## 2016.308     2811.32749 1626.6914914 4318.0199 1125.630506  5255.3059
## 2016.327     2534.91901 1418.1468035 3973.7476  953.354775  4874.7646
## 2016.346     3060.37223 1817.3972106 4625.4037 1285.157659  5593.8682
## 2016.365     3436.28453 2109.5778794 5085.0476 1532.589002  6098.2615
## 2016.385     3496.85664 2157.0949601 5158.6747 1573.128986  6178.8657
## 2016.404     3544.38422 2194.4579606 5216.3669 1605.059651  6241.9902
## 2016.423     3417.33077 2094.7327927 5061.9852 1519.939747  6073.0032
## 2016.442     4106.06462 2640.8182622 5893.3674 1989.788563  6980.6221
## 2016.462     4100.72397 2636.5355784 5886.9688 1986.071299  6973.6580
## 2016.481     4906.16729 3289.5213509 6844.8697 2557.578032  8013.0379
## 2016.500     6338.84958 4479.2505450 8520.5050 3617.463974  9818.5166
## 2016.519     5186.98677 3520.1734058 7175.8566 2761.418733  8370.8362
## 2016.538     5270.49922 3589.0301382 7274.0247 2822.442901  8476.8369
## 2016.558     5797.34323 4025.9782912 7890.7646 3211.347336  9141.6205
## 2016.577     5501.54321 3780.1223019 7545.0205 2992.183310  8769.1845
## 2016.596     6625.44928 4720.6757023 8852.2793 3834.746161 10174.4338
## 2016.615     5116.51520 3462.1610316 7092.9258 2710.065021  8281.2468
## 2016.635     4448.71331 2916.9705965 6302.5125 2230.402750  7425.3053
## 2016.654     3794.23255 2391.9585078 5518.5630 1774.583579  6572.1629
## 2016.673     4162.58023 2686.1801445 5961.0367 2029.189479  7054.2524
## 2016.692     3681.91917 2302.9566493 5382.9381 1698.040275  6424.0795
## 2016.712     4390.17215 2869.6040100 6232.7967 2189.008275  7349.6174
## 2016.731     3632.94408 2264.2579505 5323.6866 1664.833664  6359.3359
## 2016.750     3369.14148 2057.0412819 5003.2981 1487.858639  6008.7057
## 2016.769     3282.84745 1989.7352906 4898.0160 1430.700569  5893.2757
## 2016.788     2810.32651 1625.9300943 4316.7793 1124.997152  5253.9373
## 2016.808     1909.04629  961.1825996 3178.9664  586.661624  3989.7123
## 2016.827     1755.20285  852.9584196 2979.5037  502.818088  3765.8690
## 2016.846      931.63616  318.0168235 1867.3119  122.128578  2499.4251
## 2016.865      962.29862  336.0346946 1910.6190  133.388706  2549.4899
## 2016.885      560.41274  120.6339549 1322.2479   17.652625  1861.4542
## 2016.904       63.23344  -22.4462142  426.0771 -132.700951   752.0473
## 2016.923      208.05583    3.0083216  735.1598  -25.476195  1148.9169
## 2016.942      259.64447   11.7223916  829.6230  -11.276489  1266.2938
## 2016.962      179.62121    0.5077909  680.7911  -36.835817  1080.6880
## 2016.981      123.96826   -2.4198465  567.5731  -69.512770   936.7052
## 2017.000       94.68002   -7.5661760  493.3463  -88.755270   834.1545
## 2017.019      219.76105    5.4910801  745.5834  -18.723170  1154.3487
## 2017.038      280.90078   18.3103595  855.0436   -5.718185  1289.6331
## 2017.058      191.89206    1.8809485  693.4556  -28.077880  1089.2560
## 2017.077      279.04190   17.8380613  851.7982   -5.986930  1285.6466
## 2017.096      210.92247    4.1703189  729.2271  -21.420211  1133.9745
## 2017.115      196.93559    2.4097589  703.0138  -26.193857  1101.2271
## 2017.135      183.21704    1.1124655  676.8741  -31.534946  1068.4489
## 2017.154      577.11718  133.2230499 1332.5637   23.735368  1864.0487
## 2017.173      927.77902  323.2239800 1843.8865  127.873075  2461.2347
## 2017.192     1177.07497  476.4394082 2189.2630  229.739463  2857.9602
## 2017.212     1031.06060  385.3014920 1988.3721  167.929587  2627.7414
</code></pre>
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://nitinahuja.github.io/tags/forecasting/">forecasting</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2016/access-log-parsing-with-spark-and-schema-extraction-from-query-string/" data-tooltip="Access log parsing with Spark and schema extraction from query string" aria-label="NEXT: Access log parsing with Spark and schema extraction from query string">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2014/on-marketplaces-and-platforms/" data-tooltip="On Marketplaces and platforms" aria-label="PREVIOUS: On Marketplaces and platforms">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/nitinahuja.github.io\/2016\/revenue-forecast-for-seasonal-business\/';
        
          this.page.identifier = '\/2016\/revenue-forecast-for-seasonal-business\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'viewstate-1';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Nitin Ahuja. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2016/access-log-parsing-with-spark-and-schema-extraction-from-query-string/" data-tooltip="Access log parsing with Spark and schema extraction from query string" aria-label="NEXT: Access log parsing with Spark and schema extraction from query string">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2014/on-marketplaces-and-platforms/" data-tooltip="On Marketplaces and platforms" aria-label="PREVIOUS: On Marketplaces and platforms">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      

    </div>

<div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Nitin Ahuja</h4>
    
      <div id="about-card-bio">A programmer&rsquo;s viewpoint</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Forever learning
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        California
      </div>
    
  </div>
</div>




  
    
      
      <div id="cover" style="background-image:url('https://nitinahuja.github.io/images/cover.jpg');"></div>
    
  



<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>





<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://nitinahuja.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/codefolding.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/collapse.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/transition.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/dropdown.js"></script>
  





 
  <script>
  $( document ).ready(function () {
    window.initializeCodeFolding("show" === "hide");
  });
  

  </script>


</body>
</html>

