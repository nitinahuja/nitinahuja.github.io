<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>


    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/nitinahuja.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Nitin Ahuja",
    
    "image": "https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d"
    
  },
  "name":"A programmer\u0027s viewpoint",
  "description":"NPS analysis What is net promorter score (NPS)? Net Promoter Score or NPS is a customer loyalty metric and was developed by Fred Reichheld and it asks respondents to answer a single question.\nHow likely are you to recommend this product? The respondents are asked to score between 0 and 10. 10 being \u0026ldquo;most likely\u0026rdquo; to recommend and 0 being \u0026ldquo;least likely\u0026rdquo;.\nAn additional optional question is asked about why they picked this score and the response to that is usually a text comment.",
  "url":"https:\/\/nitinahuja.github.io\/2017\/nps-exploratory-analysis-in-r\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.118.2 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Nitin Ahuja">
<meta name="keywords" content="">
<meta name="description" content="NPS analysis What is net promorter score (NPS)? Net Promoter Score or NPS is a customer loyalty metric and was developed by Fred Reichheld and it asks respondents to answer a single question.
How likely are you to recommend this product? The respondents are asked to score between 0 and 10. 10 being &ldquo;most likely&rdquo; to recommend and 0 being &ldquo;least likely&rdquo;.
An additional optional question is asked about why they picked this score and the response to that is usually a text comment.">


<meta property="og:description" content="NPS analysis What is net promorter score (NPS)? Net Promoter Score or NPS is a customer loyalty metric and was developed by Fred Reichheld and it asks respondents to answer a single question.
How likely are you to recommend this product? The respondents are asked to score between 0 and 10. 10 being &ldquo;most likely&rdquo; to recommend and 0 being &ldquo;least likely&rdquo;.
An additional optional question is asked about why they picked this score and the response to that is usually a text comment.">
<meta property="og:type" content="article">
<meta property="og:title" content="NPS - Exploratory analysis in R">
<meta name="twitter:title" content="NPS - Exploratory analysis in R">
<meta property="og:url" content="https://nitinahuja.github.io/2017/nps-exploratory-analysis-in-r/">
<meta property="twitter:url" content="https://nitinahuja.github.io/2017/nps-exploratory-analysis-in-r/">
<meta property="og:site_name" content="A programmer&#39;s viewpoint">
<meta property="og:description" content="NPS analysis What is net promorter score (NPS)? Net Promoter Score or NPS is a customer loyalty metric and was developed by Fred Reichheld and it asks respondents to answer a single question.
How likely are you to recommend this product? The respondents are asked to score between 0 and 10. 10 being &ldquo;most likely&rdquo; to recommend and 0 being &ldquo;least likely&rdquo;.
An additional optional question is asked about why they picked this score and the response to that is usually a text comment.">
<meta name="twitter:description" content="NPS analysis What is net promorter score (NPS)? Net Promoter Score or NPS is a customer loyalty metric and was developed by Fred Reichheld and it asks respondents to answer a single question.
How likely are you to recommend this product? The respondents are asked to score between 0 and 10. 10 being &ldquo;most likely&rdquo; to recommend and 0 being &ldquo;least likely&rdquo;.
An additional optional question is asked about why they picked this score and the response to that is usually a text comment.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2017-08-28T00:00:00">
  
  
    <meta property="article:modified_time" content="2017-08-28T00:00:00">
  
  
  
    
      <meta property="article:section" content="R">
    
      <meta property="article:section" content="NLP">
    
  
  
    
      <meta property="article:tag" content="nlp">
    
      <meta property="article:tag" content="sentiment analysis">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@nitinahuja">


  <meta name="twitter:creator" content="@nitinahuja">






  <meta property="og:image" content="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=640">




  <meta property="og:image" content="https://lh3.googleusercontent.com/xHOxMqLRDtrTyu_ipxOWHY3I49Hyzaql9KBgqVuUIXd0YkDjTZl4EzueIAYsRMux_ISvtjmv_q2XbAOf1e90Kiy9jsLCH1Nt7RIJrTxCeyM8jjHxGSrNo7BoNjF1pJFpVAwSbrV1G4Q">
  <meta property="twitter:image" content="https://lh3.googleusercontent.com/xHOxMqLRDtrTyu_ipxOWHY3I49Hyzaql9KBgqVuUIXd0YkDjTZl4EzueIAYsRMux_ISvtjmv_q2XbAOf1e90Kiy9jsLCH1Nt7RIJrTxCeyM8jjHxGSrNo7BoNjF1pJFpVAwSbrV1G4Q">


  <meta property="og:image" content="//d1u9biwaxjngwg.cloudfront.net/cover-image-showcase/city-750.jpg">
  <meta property="twitter:image" content="//d1u9biwaxjngwg.cloudfront.net/cover-image-showcase/city-750.jpg">


    <title>NPS - Exploratory analysis in R</title>

    <link rel="icon" href="https://nitinahuja.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://nitinahuja.github.io/2017/nps-exploratory-analysis-in-r/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://nitinahuja.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://nitinahuja.github.io/css/codefolding.css">
      
    
      
        <link rel="stylesheet"  crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-105634890-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://nitinahuja.github.io/" aria-label="Go to homepage">A programmer&#39;s viewpoint</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://nitinahuja.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
  

<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>


</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://nitinahuja.github.io/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Nitin Ahuja</h4>
        
          <h5 class="sidebar-profile-bio">A programmer&rsquo;s viewpoint</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/" title="Home">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/nitinahuja" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nitinahuja.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-left
              "
       style="background-image:url('https://lh3.googleusercontent.com/xHOxMqLRDtrTyu_ipxOWHY3I49Hyzaql9KBgqVuUIXd0YkDjTZl4EzueIAYsRMux_ISvtjmv_q2XbAOf1e90Kiy9jsLCH1Nt7RIJrTxCeyM8jjHxGSrNo7BoNjF1pJFpVAwSbrV1G4Q')"
       data-behavior="4">
    
      <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      NPS - Exploratory analysis in R
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-08-28T00:00:00Z">
        
  August 28, 2017

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://nitinahuja.github.io/categories/r">R</a>, 
    
      <a class="category-link" href="https://nitinahuja.github.io/categories/nlp">NLP</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <h1 id="nps-analysis">NPS analysis</h1>
<h2 id="what-is-net-promorter-score-nps">What is net promorter score (NPS)?</h2>
<p>Net Promoter Score or NPS is a customer loyalty metric and was developed by Fred Reichheld and it asks respondents to answer a single question.</p>
<blockquote>
<p>How likely are you to recommend this product?
The respondents are asked to score between 0 and 10. 10 being &ldquo;most likely&rdquo; to recommend and 0 being &ldquo;least likely&rdquo;.</p>
</blockquote>
<p>An additional optional question is asked about why they picked this score and the response to that is usually a text comment. We will make an attempt to summarize the text as well.</p>
<p>I have NPS scores from customers of a platform that allows them to sell widgets. These scores were collected over a two year period Jun 2015 - Jun 2017, and this is an attempt to perform some exploratory data analysis and see if some more value can be extracted from this data.</p>
<p>Note that some of this data has been sanitized of proprietary information but the scores have been left untouched.</p>
<p>First, let&rsquo;s load up some packages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(NPS)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(lubridate)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(dplyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(RColorBrewer)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggridges)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(reshape2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidytext)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(wordcloud)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tm)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(stringr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(SnowballC)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">theme_set</span>(<span style="color:#a6e22e">theme_minimal</span>())
</span></span></code></pre></div><h2 id="analyze-the-data">Analyze the data.</h2>
<p>Next load up the data and take a look.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#39;~/data/nps.csv&#39;</span>, header <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>, quote <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#34;&#39;</span>
</span></span><span style="display:flex;"><span>                , na.strings<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;NA&#34;</span>, <span style="color:#e6db74">&#34;#N/A&#34;</span>)
</span></span><span style="display:flex;"><span>                , colClasses <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Feedback.Received&#34;</span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>
</span></span><span style="display:flex;"><span>                               , <span style="color:#e6db74">&#34;Comment&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;character&#34;</span>
</span></span><span style="display:flex;"><span>                               , <span style="color:#e6db74">&#34;Survey.Sent&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Date&#34;</span>
</span></span><span style="display:flex;"><span>                               , <span style="color:#e6db74">&#34;TPY&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;integer&#34;</span>
</span></span><span style="display:flex;"><span>                               ))
</span></span></code></pre></div><p>Let&rsquo;s take a look at the data.
Here is some summarized information for this data</p>
<ul>
<li>8423 total rows</li>
<li>(TPY) range from 0 - 230,000 - TPY is a measure of the widgets sold per year on the platform by the respondent.</li>
<li>Scores range from 0 - 10</li>
<li>Feedback dates are from 2015-06-23 to 2017-06-05</li>
</ul>
<p>Summarized details</p>
<pre tabindex="0"><code>##    Vertical              TPY          Non.Profit             Sent           
##  Length:8423        Min.   :   -40   Length:8423        Min.   :2015-06-23  
##  Class :character   1st Qu.:  1799   Class :character   1st Qu.:2016-01-17  
##  Mode  :character   Median :  4816   Mode  :character   Median :2016-07-18  
##                     Mean   : 10101                      Mean   :2016-07-04  
##                     3rd Qu.: 10535                      3rd Qu.:2016-12-16  
##                     Max.   :600000                      Max.   :2017-06-05  
##                     NA&#39;s   :41                          NA&#39;s   :1632        
##     Received              Score        promoter.tags      detractor.tags    
##  Min.   :2015-06-23   Min.   : 0.000   Length:8423        Length:8423       
##  1st Qu.:2015-12-31   1st Qu.: 7.000   Class :character   Class :character  
##  Median :2016-06-22   Median : 9.000   Mode  :character   Mode  :character  
##  Mean   :2016-06-17   Mean   : 7.824                                        
##  3rd Qu.:2016-11-27   3rd Qu.:10.000                                        
##  Max.   :2017-06-05   Max.   :10.000                                        
##  NA&#39;s   :6824         NA&#39;s   :6824
</code></pre><h2 id="nps">NPS</h2>
<p>Let&rsquo;s start by getting the NPS for this data. NPS scores can vary from -100 (all detractors) to 100 (all promoters).
Note that the while NPS is expressed as a number between -100 and 100, the CRAN NPS package returns results from [-1,1]. All plots use the returned results and ideally should be multiplied by 100 and rounded.
Before we can calculate that number we will need to ensure that our data actually has scores.</p>
<p>Let&rsquo;s drop all rows that don&rsquo;t have Scores.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps <span style="color:#f92672">&lt;-</span> nps <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">drop_na</span>(Score)
</span></span></code></pre></div><p>That leaves us with 1599 rows.</p>
<p>Let&rsquo;s enrich this data just a little bit. We&rsquo;ll add a column for the day of the week, month, year of received date and the days to respond. We have also added categories based on the Score. Respondents who score from 0 through 6 are considered <em>detractors</em> of the service, 7 - 8 are <em>passives</em> and 9 and 10s are considered <em>promorters</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>year <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(<span style="color:#a6e22e">year</span>(nps<span style="color:#f92672">$</span>Received))
</span></span><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>month <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cut</span>(nps<span style="color:#f92672">$</span>Received, breaks <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;month&#34;</span>)
</span></span><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>days <span style="color:#f92672">&lt;-</span> nps<span style="color:#f92672">$</span>Received <span style="color:#f92672">-</span> nps<span style="color:#f92672">$</span>Sent
</span></span><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>weekday <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">weekdays</span>(nps<span style="color:#f92672">$</span>Received)
</span></span><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>weekday <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">factor</span>(nps<span style="color:#f92672">$</span>weekday, levels <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sunday&#34;</span>, <span style="color:#e6db74">&#34;Monday&#34;</span>, <span style="color:#e6db74">&#34;Tuesday&#34;</span>, <span style="color:#e6db74">&#34;Wednesday&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Thursday&#34;</span>, <span style="color:#e6db74">&#34;Friday&#34;</span>, <span style="color:#e6db74">&#34;Saturday&#34;</span>))
</span></span><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>cat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cut</span>(nps<span style="color:#f92672">$</span>Score, breaks <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-1</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>), labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Detractor&#34;</span>, <span style="color:#e6db74">&#34;Passive&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Promoter&#34;</span>))
</span></span></code></pre></div><h3 id="overall-nps-score">Overall NPS Score</h3>
<p>What&rsquo;s the overall NPS score?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">nps</span>(nps<span style="color:#f92672">$</span>Score,  breaks <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] 0.2826767</span>
</span></span></code></pre></div><h3 id="yearly-changes">Yearly changes</h3>
<p>Has there been any change in the score over time?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>yearly <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">aggregate</span>(nps<span style="color:#f92672">$</span>Score, <span style="color:#a6e22e">list</span>(nps<span style="color:#f92672">$</span>year), FUN <span style="color:#f92672">=</span> nps, nps<span style="color:#f92672">$</span>Score)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(yearly) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1), y<span style="color:#f92672">=</span>x, fill<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1)), width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Year&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;NPS&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1), y<span style="color:#f92672">=</span>x, label<span style="color:#f92672">=</span><span style="color:#a6e22e">round</span>(x,<span style="color:#ae81ff">2</span>)),  vjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>()  <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(<span style="color:#e6db74">&#34;Year&#34;</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-8-1.png" width="672" />
<p>Looks like there has been a consistent improvement over the years.</p>
<h3 id="monthly-changes">Monthly changes</h3>
<p>Looking at the score monthly over time we can see that there is an upward trend but the growth is not consistent.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">aggregate</span>(nps<span style="color:#f92672">$</span>Score, <span style="color:#a6e22e">list</span>(nps<span style="color:#f92672">$</span>month), FUN <span style="color:#f92672">=</span> nps, nps<span style="color:#f92672">$</span>Score)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(np, <span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.Date</span>( Group.1), y<span style="color:#f92672">=</span>x)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_line</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tomato&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;loess&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Year/Month&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;NPS&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>( y<span style="color:#f92672">=</span>x, label<span style="color:#f92672">=</span><span style="color:#a6e22e">round</span>(x,<span style="color:#ae81ff">2</span>)), position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>), vjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)  <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>() 
</span></span><span style="display:flex;"><span><span style="color:#75715e">## `geom_smooth()` using formula = &#39;y ~ x&#39;</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-9-1.png" width="672" />
<h2 id="exploring-some-other-dimensions">Exploring some other dimensions</h2>
<p>Are there other dimensions that affect NPS?</p>
<h3 id="day-of-the-week">Day of the week</h3>
<p>Does the day of the week affect the score?</p>
<p>Looks like responses provided on Wednesday have a higher score. Might be something worth exploring to see if this is just random chance or if this is something real.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>daily <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">aggregate</span>(nps<span style="color:#f92672">$</span>Score, <span style="color:#a6e22e">list</span>(nps<span style="color:#f92672">$</span>weekday), FUN <span style="color:#f92672">=</span> nps, nps<span style="color:#f92672">$</span>Score)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>daily<span style="color:#f92672">$</span>Group.1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">factor</span>(daily<span style="color:#f92672">$</span>Group.1, levels <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sunday&#34;</span>, <span style="color:#e6db74">&#34;Monday&#34;</span>,<span style="color:#e6db74">&#34;Tuesday&#34;</span>, <span style="color:#e6db74">&#34;Wednesday&#34;</span>, <span style="color:#e6db74">&#34;Thursday&#34;</span>, <span style="color:#e6db74">&#34;Friday&#34;</span>, <span style="color:#e6db74">&#34;Saturday&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(daily) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1), y<span style="color:#f92672">=</span>x, fill<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1)), width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Day&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;NPS&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1), y<span style="color:#f92672">=</span>x, label<span style="color:#f92672">=</span><span style="color:#a6e22e">round</span>(x,<span style="color:#ae81ff">2</span>)),  vjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.5</span>)  <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>()  <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(<span style="color:#e6db74">&#34;Response Day&#34;</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-10-1.png" width="672" />
<p>One more view of the scores by day; do respondents leave higher score on some days?</p>
<h3 id="day-of-week-vs-scores">Day of Week vs Scores</h3>
<p>This plot shows the kernel density of the scores (0-10) received by day. It seems that respondents who leave scores on Wednesday seem to provide more 10s compared to Sunday. In fact, there seems to be a bi-modal distribution on Sunday with 5s and 10s.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nps) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_density</span>(<span style="color:#a6e22e">aes</span>( x <span style="color:#f92672">=</span> Score,  group <span style="color:#f92672">=</span> weekday, fill <span style="color:#f92672">=</span> weekday), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>) 
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-11-1.png" width="672" />
<p>Here is a ridges plot for the score density by day. It&rsquo;s harder to compare the relative heights of the score density compared to the density plot above. The bi-modal distribution of scores on Sunday is, however, quite clear here.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nps) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_density_ridges</span>(<span style="color:#a6e22e">aes</span>( x <span style="color:#f92672">=</span> Score, y <span style="color:#f92672">=</span> weekday, fill <span style="color:#f92672">=</span> weekday), scale <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(<span style="color:#e6db74">&#34;Response Day&#34;</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Picking joint bandwidth of 0.724</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-12-1.png" width="672" />
<h3 id="time-to-respond">Time to respond.</h3>
<p>How long are respondents taking to respond?</p>
<p>It seems like most responses are received on the same day as the survey was sent. There is a peak on the 5th day as well. Given the fact that responses on Wednesday seems to generate higher scores, if requests are sent on Wednesday, it may skew towards more positive scores.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nps) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(<span style="color:#a6e22e">as.numeric</span>( days)), binwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tomato&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Days to respond&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Days to respond&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Count of responses&#34;</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_cartesian</span>(xlim <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">30</span>)) 
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-13-1.png" width="672" />
<h3 id="scores-over-the-years">Scores over the years</h3>
<p>How have the scores changed over time?</p>
<p>Has the median score shifted over the years?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">subset</span>(nps, <span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(year)), <span style="color:#a6e22e">aes</span>(y<span style="color:#f92672">=</span>Score, x<span style="color:#f92672">=</span>year)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_boxplot</span>() <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>( position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jitter&#34;</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>, <span style="color:#a6e22e">aes</span>(color<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Score))) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">guides</span>(color<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>) 
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use &#34;none&#34; instead as</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## of ggplot2 3.3.4.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## This warning is displayed once every 8 hours.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## generated.</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-14-1.png" width="672" />
<p>We can see that 2017 seems to show a higher median score, but how much higher?
This plot shows the kernel density of the scores.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nps) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_density</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>Score, fill <span style="color:#f92672">=</span> year, binwidth <span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> ), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_cartesian</span>(xlim <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">scale_fill_brewer</span>(<span style="color:#e6db74">&#34;Year&#34;</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Warning in geom_density(aes(x = Score, fill = year, binwidth = 1), alpha =</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 0.5): Ignoring unknown aesthetics: binwidth</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-15-1.png" width="672" />
<p>To see a percentage distribution, we can plot the cumulative frequency distribution of the Score categories grouped by year. The plot shows what percentage of Scores fall into which category groups.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nps) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">stat_ecdf</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>cat, group <span style="color:#f92672">=</span> year, colour <span style="color:#f92672">=</span> year))
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-16-1.png" width="672" />
<p>The table below shows the exact percentage of category groups by year. One can see that while the percentage of <em>detractors</em> has remained somewhat static over the years, some of the <em>passive</em> group has shifted to being <em>promorters</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(year, cat) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(cat_count <span style="color:#f92672">=</span> <span style="color:#a6e22e">length</span>(cat)) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(pct <span style="color:#f92672">=</span> <span style="color:#a6e22e">round</span>((cat_count<span style="color:#f92672">/</span><span style="color:#a6e22e">sum</span>(cat_count)<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>),<span style="color:#ae81ff">2</span>)) 
</span></span><span style="display:flex;"><span><span style="color:#75715e">## `summarise()` has grouped output by &#39;year&#39;. You can override using the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## `.groups` argument.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 9 Ã— 4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # Groups:   year [3]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   year  cat       cat_count   pct</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   &lt;fct&gt; &lt;fct&gt;         &lt;int&gt; &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1 2015  Detractor        94  23.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 2 2015  Passive         112  27.9</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3 2015  Promoter        195  48.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 4 2016  Detractor       196  22.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 5 2016  Passive         239  27.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 6 2016  Promoter        439  50.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 7 2017  Detractor        72  22.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 8 2017  Passive          72  22.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 9 2017  Promoter        180  55.6</span>
</span></span></code></pre></div><h3 id="tpy">TPY</h3>
<p>Recall that TPY is a measure of the widgets sold on the platform.
Does the TPY affect score?
We are going to create some groups based on the TPY number. It seems clear that the customers at 20,000 and below TPY levels are happier than the larger sized customers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Add TPY levels</span>
</span></span><span style="display:flex;"><span>nps<span style="color:#f92672">$</span>tp_level <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cut</span>(nps<span style="color:#f92672">$</span>TPY, breaks<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">5000</span>, <span style="color:#ae81ff">10000</span>, <span style="color:#ae81ff">15000</span>, <span style="color:#ae81ff">20000</span>, <span style="color:#ae81ff">50000</span>, <span style="color:#f92672">+</span><span style="color:#66d9ef">Inf</span>), labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;0-5,000&#34;</span>, <span style="color:#e6db74">&#34;10,000&#34;</span>, <span style="color:#e6db74">&#34;15,000&#34;</span>, <span style="color:#e6db74">&#34;20,000&#34;</span>, <span style="color:#e6db74">&#34;50,000&#34;</span>, <span style="color:#e6db74">&#34;50,000+&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tix <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">aggregate</span>(nps<span style="color:#f92672">$</span>Score, <span style="color:#a6e22e">list</span>(nps<span style="color:#f92672">$</span>tp_level), FUN <span style="color:#f92672">=</span> nps, nps<span style="color:#f92672">$</span>Score)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(tix) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1), y<span style="color:#f92672">=</span>x, fill<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1))) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;TPY&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;NPS&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">as.factor</span>(Group.1), y<span style="color:#f92672">=</span>x, label<span style="color:#f92672">=</span><span style="color:#a6e22e">round</span>(x,<span style="color:#ae81ff">2</span>)), position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>), hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(<span style="color:#e6db74">&#34;TPY&#34;</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>()
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-18-1.png" width="672" />
<h3 id="for-profit-vs-non-profit-customers">For profit vs non-profit customers</h3>
<p>There is a flag that shows if the respondent is a non-profit. It seems that for profit customers have higher satisfaction.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>profit <span style="color:#f92672">&lt;-</span> nps <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(Non.Profit)) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(Non.Profit) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(nps <span style="color:#f92672">=</span> <span style="color:#a6e22e">nps</span>(Score))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(profit) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>Non.Profit, y<span style="color:#f92672">=</span>nps, fill<span style="color:#f92672">=</span>Non.Profit), width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;For Profit&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;NPS&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>Non.Profit, y<span style="color:#f92672">=</span>nps, label<span style="color:#f92672">=</span><span style="color:#a6e22e">round</span>(nps,<span style="color:#ae81ff">2</span>)), position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>), hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>) <span style="color:#f92672">+</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(<span style="color:#e6db74">&#34;For Profit&#34;</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>()
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-19-1.png" width="672" />
<h3 id="verticals">Verticals</h3>
<p>The data has a column that shows the vertical of the respondent. This is an indicator of the category of widget being sold by the platform.</p>
<p>The PrA vertical has the largest number of respondents.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>vertical <span style="color:#f92672">&lt;-</span> nps <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(Vertical)) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(Vertical) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tally</span>() <span style="color:#f92672">%&gt;%</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by n</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(vertical, <span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">reorder</span>(Vertical, n), y <span style="color:#f92672">=</span> n)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> Vertical))  <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">guides</span>(fill<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggtitle</span>(<span style="color:#e6db74">&#34;Top 10 Verticals&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">+</span><span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;count&#34;</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>()
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-20-1.png" width="672" />
<h3 id="score-by-vertical">Score by Vertical</h3>
<p>What&rsquo;s the NPS score by Vertical? There seems to be a large variation of NPS by Vertical. Not sure if some connection should be derived from this. This may be something to explore further.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>vert_score <span style="color:#f92672">&lt;-</span> nps  <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(Vertical) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(nps <span style="color:#f92672">=</span> <span style="color:#a6e22e">nps</span>(Score))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(vert_score) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">reorder</span>(Vertical, nps), y<span style="color:#f92672">=</span>nps, fill<span style="color:#f92672">=</span>Vertical)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">guides</span>(fill<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_discrete</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vertical&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;NPS&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Vertical&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>Vertical, y<span style="color:#f92672">=</span>nps, label<span style="color:#f92672">=</span><span style="color:#a6e22e">round</span>(nps,<span style="color:#ae81ff">2</span>)), position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>),vjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>) 
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-21-1.png" width="672" />
<p>As evident from this that there are several dimensions to guide us about the respondents and what they like about the platform. The next steps here would be to try and perform classification and machine learning techniques to examine this data further.</p>
<p>Before we get into ML, let&rsquo;s perform some more exploration on the text included in the data.</p>
<h1 id="text-analysis">Text Analysis</h1>
<p>This part will try to analyze the sentiment of the comments to perhaps try and understand what the detractors don&rsquo;t like and what the promoters like.
To do this we will try and perform the following tasks.</p>
<h2 id="introduction">Introduction</h2>
<ul>
<li>Tokenize the text comments. We will explore both with word and sentence level tokens.</li>
<li>Perform sentiment analysis using three different sentiment lexicons. These are pre-scored dictionaries that have sentiment scores already assigned at word levels.</li>
<li>Look at term document frequencies</li>
<li>Try and explore n-grams to see relationship between words.</li>
<li>Finally, try out the word2vec neural network to explore the corpus.</li>
</ul>
<h3 id="tokenization">Tokenization</h3>
<p>We will keep the categories in place to see how the sentiment correlates to the scores.
Let&rsquo;s see how many comments we have from each category.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>comments <span style="color:#f92672">&lt;-</span> nps <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(Comment)) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(cat, Comment) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(<span style="color:#a6e22e">row_number</span>(), cat) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>comments <span style="color:#f92672">&lt;-</span> comments <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">ungroup</span>()
</span></span></code></pre></div><p>Next we will use <em>unnest_tokens</em> from the tidytext package to tokenize the words while retaining the corresponding categories. We end up with about 24,000 words.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">&lt;-</span> comments <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">unnest_tokens</span>(word, Comment)
</span></span><span style="display:flex;"><span>nps_words
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 24,460 Ã— 3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    cat      `row_number()` word      </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;fct&gt;             &lt;int&gt; &lt;chr&gt;     </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 Promoter              1 customer  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 Promoter              1 service   </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 Promoter              2 intuitive </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 Promoter              2 program   </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 Promoter              2 and       </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 Promoter              2 accessible</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 Promoter              2 support   </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 Promoter              3 easy      </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 Promoter              3 to        </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 Promoter              3 use       </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 24,450 more rows</span>
</span></span></code></pre></div><p>Our next step is to remove some common words that are not useful for analysis. These include pronouns, articles and other common words. The tidytext package already includes a wide range of these in the <em>stop_words</em> dataset.</p>
<p>We are left with about 2243 unique words with</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">&lt;-</span>  nps_words <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">anti_join</span>(stop_words, by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>))
</span></span><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">count</span>(word, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 2,244 Ã— 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    word         n</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;chr&gt;    &lt;int&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 platform   353</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 service    280</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 customer   229</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 system     191</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 support    187</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 easy       155</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 ease       142</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 ticket      91</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 friendly    89</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 user        84</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 2,234 more rows</span>
</span></span></code></pre></div><h2 id="sentiment-analysis">Sentiment Analysis</h2>
<p>We will be using three different sentiment dictionaries to test out the sentiments for each comment.</p>
<p>The plot below shows the sentiments grouped by the category using the <em>Afinn</em> dictionary. The Afinn dictionary assigns a score from -5 to 5 with -5 being negative words and 5 being positive.
It&rsquo;s clear that the detractor comments are less positive than the promoters.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;afinn&#34;</span>), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(cat) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(sentiment <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(value)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>cat, y <span style="color:#f92672">=</span> sentiment, fill <span style="color:#f92672">=</span> cat)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>cat, y<span style="color:#f92672">=</span>sentiment, label<span style="color:#f92672">=</span>sentiment), position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>), hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>) <span style="color:#f92672">+</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">guides</span>(fill<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sentiments from Comments by Category - Afinn&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Category&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sentiment&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-27-1.png" width="672" />
<p>Let&rsquo;s try another lexicon. This one is called <em>Bing</em> and was produced by Bing Liu et al.
This classifies words with a label signifying positive or negative. Here is a sample of words from this lexicon.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 6,786 Ã— 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    word        sentiment</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;chr&gt;       &lt;chr&gt;    </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 2-faces     negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 abnormal    negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 abolish     negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 abominable  negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 abominably  negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 abominate   negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 abomination negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 abort       negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 aborted     negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 aborts      negative </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 6,776 more rows</span>
</span></span></code></pre></div><p>Next, let&rsquo;s look at the sentiments for each category using the <em>Bing</em> dictionary.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(cat, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">spread</span>(sentiment, n, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(sentiment <span style="color:#f92672">=</span> positive <span style="color:#f92672">-</span> negative) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>cat, y <span style="color:#f92672">=</span> sentiment, fill <span style="color:#f92672">=</span> cat)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>cat, y<span style="color:#f92672">=</span>sentiment, label<span style="color:#f92672">=</span>sentiment), position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>), hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">guides</span>(fill<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sentiments from Comments by Category - Bing&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Category&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sentiment&#34;</span>)
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-29-1.png" width="672" />
<p>While both lexicons show the same relative trends and proportions, the absolute numbers vary significantly.
It might be worth taking a quick look at the words that are contributing to each sentiment.</p>
<p>This can be achieved by plotting the positive and negative words from the previous set.
It&rsquo;s clear from this list that if we had used some kind of stemmer before creating this list, some of the words with the same roots would have been eliminated, these are words like <em>ease</em> and <em>easy</em> and <em>issues</em> and <em>issue</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(word, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">10</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">reorder</span>(word, n), y <span style="color:#f92672">=</span> n, fill <span style="color:#f92672">=</span> sentiment)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>( <span style="color:#f92672">~</span> sentiment, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Word counts by Sentiment - Bing&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Word&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Count&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by n</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-30-1.png" width="672" />
<p>Before we run the stemmer, let&rsquo;s examine the top sentiment contributor words by category as well to illustrate one more potential gotcha.
A word like <em>helpful</em> in the detractors column could, depending on the context, have a negative connotation if preceded by the word <em>not</em>. In fact unigrams (word tokens) will have this issue with negation in most cases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(cat, word, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(cat, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">reorder</span>(word, n), y <span style="color:#f92672">=</span> n, fill <span style="color:#f92672">=</span> sentiment)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>( <span style="color:#f92672">~</span>cat, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Word counts by Sentiment by Category - Bing&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Words&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Count&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by n</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-31-1.png" width="672" />
<h3 id="stemming">Stemming</h3>
<p>We ran the Porter stemmer from the SnowballC package on both the comments and the sentiment lexicon to enable us to join on the same words. The words <em>issue</em> and <em>issues</em> have now been stemmed to the root word <em>issu</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(word <span style="color:#f92672">=</span> <span style="color:#a6e22e">wordStem</span>(word)) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(word <span style="color:#f92672">=</span> <span style="color:#a6e22e">wordStem</span>(word)), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(word, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">10</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">reorder</span>(word, n), y <span style="color:#f92672">=</span> n, fill <span style="color:#f92672">=</span> sentiment)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>( <span style="color:#f92672">~</span> sentiment, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Word counts by Sentiment - Bing (Stemmed)&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Words&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Count&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by n</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-32-1.png" width="672" />
<p>Let&rsquo;s try to group by catgory with stemming. It&rsquo;s clear that there is a larger proportion of negative sentiment words in the <em>detractor</em> comments and a smaller proportion for <em>promorters</em>. This line of exploration has confirmed our belief that detractors are leaving negative comments and promorters are generally upbeat and positive.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(word <span style="color:#f92672">=</span> <span style="color:#a6e22e">wordStem</span>(word)) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(word <span style="color:#f92672">=</span> <span style="color:#a6e22e">wordStem</span>(word)), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(cat, word, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(cat, sentiment) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span><span style="color:#a6e22e">reorder</span>(word, n), y <span style="color:#f92672">=</span> n, fill <span style="color:#f92672">=</span> sentiment)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>( <span style="color:#f92672">~</span>cat, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Word counts by Sentiment by Category - Bing (Stemmed)&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Words&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Count&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Warning in inner_join(., get_sentiments(&#34;bing&#34;) %&gt;% mutate(word = wordStem(word)), : Detected an unexpected many-to-many relationship between `x` and `y`.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## â„¹ Row 5 of `x` matches multiple rows in `y`.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## â„¹ Row 5908 of `y` matches multiple rows in `x`.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## â„¹ If a many-to-many relationship is expected, set `relationship =</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   &#34;many-to-many&#34;` to silence this warning.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by n</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-33-1.png" width="672" />
<h3 id="ngrams">ngrams</h3>
<p>Ngrams are series of words in sequence; bigrams are two words together and trigrams are three.
Lets take a quick look at the bigrams in the comments to see what those phrases are.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>comments <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">unnest_tokens</span>(ngram, Comment, token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ngrams&#34;</span>, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">count</span>(ngram, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 13,715 Ã— 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    ngram                n</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;chr&gt;            &lt;int&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 customer service   165</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 ease of            134</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 to use             122</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 easy to            113</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 of use             110</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 of the              75</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 i have              71</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 the system          71</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 user friendly       69</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 it is               67</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 13,705 more rows</span>
</span></span></code></pre></div><p>In this case we have not removed the stop words, let&rsquo;s try looking at the trigrams to see if those provide more meaning. These are phrases that have the word <em>not</em> prefixed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>comments <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">unnest_tokens</span>(ngram, Comment, token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ngrams&#34;</span>, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">count</span>(ngram, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">str_detect</span>(ngram, <span style="color:#e6db74">&#39;^not &#39;</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 182 Ã— 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    ngram                      n</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;chr&gt;                  &lt;int&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 not a 10                   3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 not been fixed             3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 not being able             3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 not able to                2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 not as flexible            2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 not been as                2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 not flexible enough        2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 not give a                 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 not handle the             2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 not recommend platform     2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 172 more rows</span>
</span></span></code></pre></div><p>As a final step in this exploration, we will create a comparison word cloud</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">par</span>(mar<span style="color:#f92672">=</span><span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot.new</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(<span style="color:#a6e22e">get_sentiments</span>(<span style="color:#e6db74">&#34;bing&#34;</span>), by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;word&#39;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(word, sentiment, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">acast</span>(word <span style="color:#f92672">~</span> sentiment, value.var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n&#34;</span>, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">comparison.cloud</span>( random.order<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>,title.size<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>, max.words<span style="color:#f92672">=</span><span style="color:#ae81ff">150</span>, colors <span style="color:#f92672">=</span> <span style="color:#a6e22e">brewer.pal</span>(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">&#34;Set1&#34;</span>))
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-36-1.png" width="672" />
<p>And another one grouped by the categories.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">par</span>(mar<span style="color:#f92672">=</span><span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot.new</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nps_words <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(word, cat, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">acast</span>(word <span style="color:#f92672">~</span> cat, value.var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n&#34;</span>, fill <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">comparison.cloud</span>( random.order<span style="color:#f92672">=</span><span style="color:#66d9ef">FALSE</span>,title.size<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>, max.words<span style="color:#f92672">=</span><span style="color:#ae81ff">250</span>, colors <span style="color:#f92672">=</span> <span style="color:#a6e22e">brewer.pal</span>(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">&#34;Set1&#34;</span>))
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-37-1.png" width="672" />
<h3 id="ranking-and-tf-idf">Ranking and tf-idf</h3>
<p>A central question in text analysis deals with what the text is about, to explore that, we will try to do different things;</p>
<ul>
<li>Try and rank the terms using tf-idf (term frequency - inverse document frequency)</li>
<li>Try to extract the topic or subject of the text using LDA (Latent Dirichlet allocation )</li>
</ul>
<p>The statsitic <em>tf-idf</em> measures how important a term is to a document in a collection of documents. So in our context we are trying to see if a term/word has special meaning in one respondent&rsquo;s comments in relation to <em>all</em> other comments.</p>
<p>We will use the bind_tf_idf function to extract the statistic and sort based on the relative importance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_tf_idf <span style="color:#f92672">&lt;-</span> comments <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">unnest_tokens</span>(word,Comment) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(cat, word, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bind_tf_idf</span>(word, cat, n) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">arrange</span>(<span style="color:#a6e22e">desc</span>(tf_idf))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nps_tf_idf
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 4,485 Ã— 6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    cat       word                n       tf   idf   tf_idf</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;fct&gt;     &lt;chr&gt;           &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 Detractor lack               24 0.00258  0.405 0.00105 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 Promoter  reasonable          7 0.000843 1.10  0.000926</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 Passive   smith               5 0.000730 1.10  0.000801</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 Passive   under               5 0.000730 1.10  0.000801</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 Detractor contract            6 0.000645 1.10  0.000708</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 Detractor income              6 0.000645 1.10  0.000708</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 Detractor won&#39;t               6 0.000645 1.10  0.000708</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 Promoter  professionalism     5 0.000602 1.10  0.000662</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 Promoter  respond             5 0.000602 1.10  0.000662</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 Passive   part                4 0.000584 1.10  0.000641</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 4,475 more rows</span>
</span></span></code></pre></div><p>Let&rsquo;s plot this next by category.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_tf_idf <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(cat) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">15</span>) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(<span style="color:#a6e22e">reorder</span>(<span style="color:#a6e22e">as.factor</span>(word), tf_idf), tf_idf, fill <span style="color:#f92672">=</span> cat )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(show.legend <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TF-IDF by Category&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;words&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>cat, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by tf_idf</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-39-1.png" width="672" />
<p>This shows some proper nouns and pronouns, which is to be expected as only few comments would have those relative to the others.</p>
<h3 id="tf-idf-with-bigrams">TF-IDF with bigrams</h3>
<p>As a variation on this - let&rsquo;s repeat this with bigrams to see if certain phrases are more important.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_tf_idf_bigram <span style="color:#f92672">&lt;-</span> comments <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">unnest_tokens</span>(ngram,Comment, token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ngrams&#34;</span>, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">count</span>(cat, ngram, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bind_tf_idf</span>(ngram, cat, n) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">arrange</span>(<span style="color:#a6e22e">desc</span>(tf_idf))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nps_tf_idf_bigram
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # A tibble: 16,174 Ã— 6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    cat       ngram              n       tf   idf   tf_idf</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    &lt;fct&gt;     &lt;chr&gt;          &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1 Promoter  great customer    43 0.00557  0.405 0.00226 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2 Detractor lack of           24 0.00265  0.405 0.00107 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3 Promoter  friendly great     7 0.000907 1.10  0.000997</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4 Passive   would like        16 0.00243  0.405 0.000985</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5 Promoter  the staff          6 0.000778 1.10  0.000854</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6 Promoter  use great          6 0.000778 1.10  0.000854</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7 Promoter  very easy          6 0.000778 1.10  0.000854</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8 Detractor follow up          7 0.000773 1.10  0.000849</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9 Promoter  great product     16 0.00207  0.405 0.000841</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10 Passive   great but          5 0.000759 1.10  0.000834</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # â„¹ 16,164 more rows</span>
</span></span></code></pre></div><p>Break this up by category.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>nps_tf_idf_bigram <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">group_by</span>(cat) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">15</span>) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ungroup</span>() <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(<span style="color:#a6e22e">reorder</span>(<span style="color:#a6e22e">as.factor</span>(ngram), tf_idf), tf_idf, fill <span style="color:#f92672">=</span> cat )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(show.legend <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TF-IDF by Category - Top bigrams&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bigrams&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>cat, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Selecting by tf_idf</span>
</span></span></code></pre></div><img src="https://nitinahuja.github.io/post/2017-08-28-nps-exploratory-analysis-in-r_files/figure-html/unnamed-chunk-41-1.png" width="672" />
<h2 id="conclusion">Conclusion</h2>
<p>Here are a few clear takeaways from this analysis</p>
<ul>
<li><em>Passive</em> respondents from prior years have become <em>Promorters</em>.</li>
<li>Respondents seem to provide higher Scores on <em>Wednesday</em>.</li>
<li><em>Customer Service</em> has a huge positve impact on the scores.</li>
<li>Response rates are quite low - 19  percent</li>
<li>Product is generally <em>user friendly</em>.</li>
<li>Low and mid segment users are happier than higher sales respondents.</li>
</ul>

              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://nitinahuja.github.io/tags/nlp/">nlp</a>

  <a class="tag tag--primary tag--small" href="https://nitinahuja.github.io/tags/sentiment-analysis/">sentiment analysis</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2017/managing-managers-some-thoughts/" data-tooltip="Managing managers - some thoughts" aria-label="NEXT: Managing managers - some thoughts">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2016/forecasting-in-r-philadelphia-crime-data/" data-tooltip="Forecasting in R - Philadelphia crime data" aria-label="PREVIOUS: Forecasting in R - Philadelphia crime data">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/nitinahuja.github.io\/2017\/nps-exploratory-analysis-in-r\/';
        
          this.page.identifier = '\/2017\/nps-exploratory-analysis-in-r\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'viewstate-1';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Nitin Ahuja. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2017/managing-managers-some-thoughts/" data-tooltip="Managing managers - some thoughts" aria-label="NEXT: Managing managers - some thoughts">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://nitinahuja.github.io/2016/forecasting-in-r-philadelphia-crime-data/" data-tooltip="Forecasting in R - Philadelphia crime data" aria-label="PREVIOUS: Forecasting in R - Philadelphia crime data">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      

    </div>

<div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/2a9756e94950a1dabeb63034558f787d?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Nitin Ahuja</h4>
    
      <div id="about-card-bio">A programmer&rsquo;s viewpoint</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Forever learning
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        California
      </div>
    
  </div>
</div>




  
    
      
      <div id="cover" style="background-image:url('https://nitinahuja.github.io/images/cover.jpg');"></div>
    
  



<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>





<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://nitinahuja.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/codefolding.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/collapse.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/transition.js"></script>
  

  
    <script src="https://nitinahuja.github.io/js/dropdown.js"></script>
  





 
  <script>
  $( document ).ready(function () {
    window.initializeCodeFolding("show" === "hide");
  });
  

  </script>


</body>
</html>

